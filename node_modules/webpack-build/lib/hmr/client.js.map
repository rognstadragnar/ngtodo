{"version":3,"sources":["../../src/hmr/client.js"],"names":[],"mappings":";;;;8BAA2B,kBAAkB;;;;yBACvB,YAAY;;;;AAElC,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;;AAElD,IAAM,MAAM,GAAG,iCAAe,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,EAAE;AACxD,MAAI,EAAE,IAAI,CAAC,IAAI;CAChB,CAAC,CAAC;;AAEH,IAAM,MAAM,GAAG,SAAT,MAAM,GAAS;AACnB,SAAO,CAAC,IAAI,yCAAuC,WAAW,SAAM,CAAC;;AAErE,QAAM,CAAC,WAAW,sBAAoB,WAAW,EAAI,GAAG,CAAC,CAAC;CAC3D,CAAC;;;;AAIF,MAAM,CAAC,EAAE,CAAC,SAAS,EAAE;SAAM,OAAO,CAAC,IAAI,6BAA2B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAG;CAAA,CAAC,CAAC;;AAE7G,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE,UAAC,GAAG;SAAK,OAAO,CAAC,KAAK,oCAAkC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,EAAI,GAAG,CAAC;CAAA,CAAC,CAAC;;AAE3H,MAAM,CAAC,EAAE,CAAC,YAAY,EAAE;SAAM,OAAO,CAAC,IAAI,CAAC,wBAAwB,CAAC;CAAA,CAAC,CAAC;;AAEtE,MAAM,CAAC,EAAE,CAAC,WAAW,EAAE,UAAC,OAAO;SAAK,OAAO,CAAC,IAAI,uCAAqC,OAAO,CAAG;CAAA,CAAC,CAAC;;AAEjG,MAAM,CAAC,EAAE,CAAC,cAAc,EAAE;SAAM,OAAO,CAAC,IAAI,qCAAqC;CAAA,CAAC,CAAC;;;;AAInF,IAAI,WAAW,GAAG,EAAE,CAAC;;AAErB,MAAM,CAAC,EAAE,CAAC,KAAK,EAAE;SAAM,OAAO,CAAC,IAAI,CAAC,0CAA0C,CAAC;CAAA,CAAC,CAAC;;AAEjF,MAAM,CAAC,EAAE,CAAC,SAAS,EAAE;SAAM,OAAO,CAAC,IAAI,CAAC,4CAA4C,CAAC;CAAA,CAAC,CAAC;;AAEvF,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE,UAAC,IAAI,EAAK;AAC1B,aAAW,GAAG,IAAI,CAAC;CACpB,CAAC,CAAC;;AAEH,MAAM,CAAC,EAAE,CAAC,WAAW,EAAE;SAAM,OAAO,CAAC,IAAI,CAAC,2BAA2B,CAAC;CAAA,CAAC,CAAC;;AAExE,MAAM,CAAC,EAAE,CAAC,SAAS,EAAE,YAAM;AACzB,SAAO,CAAC,IAAI,CAAC,2CAA2C,CAAC,CAAC;AAC1D,QAAM,EAAE,CAAC;CACV,CAAC,CAAC;;AAEH,MAAM,CAAC,EAAE,CAAC,UAAU,EAAE,UAAC,QAAQ,EAAK;AAClC,SAAO,CAAC,IAAI,CAAC,uCAAuC,CAAC,CAAC;;;;;;;AAEtD,yBAAoB,QAAQ,8HAAE;UAArB,OAAO;;AACd,aAAO,CAAC,IAAI,CAAC,4BAAU,OAAO,CAAC,CAAC,CAAC;KAClC;;;;;;;;;;;;;;;;AAED,QAAM,EAAE,CAAC;CACV,CAAC,CAAC;;AAEH,MAAM,CAAC,EAAE,CAAC,QAAQ,EAAE,UAAC,MAAM,EAAK;AAC9B,SAAO,CAAC,KAAK,CAAC,qCAAqC,CAAC,CAAC;;;;;;;AAErD,0BAAkB,MAAM,mIAAE;UAAjB,KAAK;;AACZ,aAAO,CAAC,IAAI,CAAC,4BAAU,KAAK,CAAC,CAAC,CAAC;KAChC;;;;;;;;;;;;;;;;AAED,QAAM,EAAE,CAAC;CACV,CAAC,CAAC","file":"client.js","sourcesContent":["import socketIoClient from 'socket.io-client';\nimport stripAnsi from 'strip-ansi';\n\nconst opts = JSON.parse(__resourceQuery.slice(1));\n\nconst socket = socketIoClient(opts.root + opts.namespace, {\n  path: opts.path\n});\n\nconst reload = () => {\n  console.info(`[WPB-HMR] Triggering HMR with hash ${currentHash}...`);\n\n  window.postMessage(`webpackHotUpdate${currentHash}`, '*');\n};\n\n// Socket handling\n\nsocket.on('connect', () => console.info(`[WPB-HMR] Connected to ${opts.root}${opts.path}${opts.namespace}`));\n\nsocket.on('error', (err) => console.error(`[WPB-HMR] Connection error to ${opts.root}${opts.path}${opts.namespace}`, err));\n\nsocket.on('disconnect', () => console.warn('[WPB-HMR] Disconnected'));\n\nsocket.on('reconnect', (attempt) => console.info(`[WPB-HMR] Reconnected on attempt ${attempt}`));\n\nsocket.on('reconnecting', () => console.info(`[WPB-HMR] Attempting to reconnect`));\n\n// HMR handling\n\nlet currentHash = '';\n\nsocket.on('hot', () => console.info('[WPB-HMR] Hot Module Replacement enabled'));\n\nsocket.on('invalid', () => console.info('[WPB-HMR] Changes detected. Recompiling...'));\n\nsocket.on('hash', (hash) => {\n  currentHash = hash;\n});\n\nsocket.on('no-change', () => console.info('[WPB-HMR] Nothing changed'));\n\nsocket.on('success', () => {\n  console.info('[WPB-HMR] Compiler completed successfully');\n  reload();\n});\n\nsocket.on('warnings', (warnings) => {\n  console.warn('[WPB-HMR] Warnings while compiling...');\n\n  for (let warning of warnings) {\n    console.warn(stripAnsi(warning));\n  }\n\n  reload();\n});\n\nsocket.on('errors', (errors) => {\n  console.error('[WPB-HMR] Errors while compiling...');\n\n  for (let error of errors) {\n    console.warn(stripAnsi(error));\n  }\n\n  reload();\n});"]}