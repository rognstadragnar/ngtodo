{"version":3,"sources":["../../src/bin/webpack-build.js"],"names":[],"mappings":"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","file":"webpack-build.js","sourcesContent":["\n\n// Ensure source map support as early as possible\nimport '../utils/source_map_support';\n\nimport path from 'path';\nimport pathIsAbsolute from 'path-is-absolute'; // used for compatibility\nimport fs from 'fs';\nimport _ from 'lodash';\nimport yargs from 'yargs';\nimport chalk from 'chalk';\nimport build from '..';\nimport options from '../options'\nimport server from '../server';\nimport workers from '../workers';\nimport defaults from '../options/defaults';\nimport packageJson from '../../package';\n\nconst argv = yargs\n  .option('c', {\n    alias: 'config',\n    description: 'A path to a config file',\n    default: 'webpack.config.js'\n  })\n  .option('d', {\n    alias: 'development',\n    description: 'Activate development mode',\n    default: false\n  })\n  .option('p', {\n    alias: 'port',\n    description: 'Specify the server\\'s port',\n    default: 9009\n  })\n  .option('a', {\n    alias: 'address',\n    description: 'Specify the server\\'s address',\n    default: '127.0.0.1'\n  })\n  .option('s', {\n    alias: 'server',\n    description: 'Run a build server',\n    default: false\n  })\n  .option('hmr', {\n    alias: 'hot-module-replacement',\n    description: 'Activate hot-module-replacement',\n    default: options.defaults.hmr\n  })\n  .option('pp', {\n    alias: 'public-path',\n    description: 'Defines the publicPath build option',\n    default: options.defaults.publicPath\n  })\n  .option('w', {\n    alias: 'watch',\n    description: 'Activates a watching compiler',\n    default: options.defaults.watch\n  })\n  .option('wo', {\n    alias: 'workers',\n    description: 'Specify the number of workers to use',\n    default: workers.defaultWorkers\n  })\n  .version(() => packageJson.version)\n  .alias('v', 'version')\n  .help('h').alias('h', 'help')\n  .strict()\n  .argv;\n\nlet config = argv.config;\nif (!pathIsAbsolute(config)) {\n  config = path.join(process.cwd(), config);\n}\nif (!fs.existsSync(config)) {\n  config = null;\n}\n\nconst startupOutput = [];\n\nstartupOutput.push(`${packageJson.name} v${packageJson.version}\\n`);\n\nif (!config && !argv.server) {\n  throw new Error('Config file \"webpack.config.js\" does not exist or the --server argument has not been specified');\n}\n\nif (argv.hmr) {\n  argv.watch = true;\n}\n\nfunction emitBuildInformation(err, data) {\n  if (err) {\n    console.error(chalk.red(err.stack || err));\n  } else {\n    console.log(chalk.blue(`Files emitted:`));\n    for (let asset of data.assets) {\n      console.log(chalk.blue(`  ${asset}`));\n    }\n  }\n}\n\nfunction buildConfigFile(config) {\n  console.log(`Building ${config}...\\n`);\n\n  build({\n    config: config,\n    watch: argv.watch,\n    context: {\n      development: argv.development\n    },\n    hmr: argv.hmr,\n    publicPath: argv.publicPath\n  }, emitBuildInformation);\n}\n\nconst url = `http://${argv.address}:${argv.port}`;\n\nif (argv.server || argv.hmr) {\n  defaults.hmrRoot = url;\n\n  workers.spawn(argv.workers);\n  for (let worker of workers.workers) {\n    startupOutput.push(`Worker #${worker.worker.id} - ${worker.worker.process.pid}`);\n  }\n}\n\nfunction flushStartupOutput() {\n  for (let message of startupOutput) {\n    console.log(message);\n  }\n}\n\nif (argv.server) {\n  server.listen(argv.port, argv.address, () => {\n    startupOutput.push(`\\nListening at ${url}\\n`);\n    flushStartupOutput();\n  });\n} else if (argv.hmr) {\n  server.listen(argv.port, argv.address, () => {\n    startupOutput.push(`\\nListening at ${url}\\n`);\n    flushStartupOutput();\n\n    buildConfigFile(config);\n  });\n} else {\n  flushStartupOutput();\n  buildConfigFile(config);\n}\n"]}