{"version":3,"sources":["../../src/utils/check_config_file.js"],"names":[],"mappings":";;;;;;;;kBAAe,IAAI;;;;sBACL,QAAQ;;;;AAEtB,IAAM,cAAc,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;;AAE3C,IAAM,eAAe,GAAG,SAAlB,eAAe,CAAI,IAAI,EAAK;AAChC,MAAI,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC;;AAE7B,MAAI,CAAC,UAAU,EAAE;AACf,WAAO,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;GAC7C;;AAED,MAAI,CAAC,oBAAE,QAAQ,CAAC,UAAU,CAAC,EAAE;AAC3B,WAAO,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;GACpD;;AAED,MAAI,SAAS,YAAA,CAAC;AACd,MAAI;AACF,aAAS,GAAG,CAAC,gBAAG,QAAQ,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC;GAC5C,CAAC,OAAM,GAAG,EAAE;AACX,OAAG,CAAC,OAAO,gCAA8B,UAAU,UAAK,GAAG,CAAC,OAAO,AAAE,CAAC;AACtE,WAAO,GAAG,CAAC;GACZ;;AAED,MAAI,CAAC,cAAc,CAAC,UAAU,CAAC,EAAE;AAC/B,QAAI;AACF,aAAO,CAAC,UAAU,CAAC,CAAC;KACrB,CAAC,OAAM,GAAG,EAAE;AACX,SAAG,CAAC,OAAO,qCAAmC,UAAU,UAAK,GAAG,CAAC,OAAO,AAAE,CAAC;AAC3E,aAAO,GAAG,CAAC;KACZ;AACD,kBAAc,CAAC,UAAU,CAAC,GAAG,SAAS,CAAC;GACxC,MAAM,IAAI,SAAS,GAAG,cAAc,CAAC,UAAU,CAAC,EAAE;AACjD,WAAO,IAAI,KAAK,CACd,oHAAoH,CACrH,CAAC;GACH;CACF,CAAC;;qBAEa,eAAe","file":"check_config_file.js","sourcesContent":["import fs from 'fs';\nimport _ from 'lodash';\n\nconst fileTimestamps = Object.create(null);\n\nconst checkConfigFile = (opts) => {\n  let configFile = opts.config;\n\n  if (!configFile) {\n    return new Error('Config file not defined');\n  }\n\n  if (!_.isString(configFile)) {\n    return new Error('Config option must be a string');\n  }\n\n  let timestamp;\n  try {\n    timestamp = +fs.statSync(configFile).mtime;\n  } catch(err) {\n    err.message = `Cannot find config file ${configFile}: ${err.message}`;\n    return err;\n  }\n\n  if (!fileTimestamps[configFile]) {\n    try {\n      require(configFile);\n    } catch(err) {\n      err.message = `Failed to import config file ${configFile}: ${err.message}`;\n      return err;\n    }\n    fileTimestamps[configFile] = timestamp;\n  } else if (timestamp > fileTimestamps[configFile]) {\n    return new Error(\n      'Config file has changed since being loaded into memory, the process will need to be restarted to apply the changes'\n    );\n  }\n};\n\nexport default checkConfigFile;"]}